const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["../chunks/DLRDrQLf.js","../chunks/DCj4iFuT.js"])))=>i.map(i=>d[i]);
import"../chunks/NZTpNUN0.js";import{i as O}from"../chunks/DK3Qv-gY.js";import{p as W,o as Y,f as y,I as q,t as z,b as i,c as F,s as A,d as l,g as s,m as S,J as G,h as n,r as c,K as H,k as m,i as Q,j as X}from"../chunks/BKL8hVvl.js";import{i as f}from"../chunks/DUN4N4P8.js";import{g as v}from"../chunks/t-ZXMKOV.js";import{A as b}from"../chunks/u5NA2Mim.js";import{_ as Z,$ as T}from"../chunks/DCj4iFuT.js";import{_ as $}from"../chunks/D9Z9MdNV.js";const C=Z("Browser",{web:()=>$(()=>import("../chunks/DLRDrQLf.js"),__vite__mapDeps([0,1]),import.meta.url).then(g=>new g.BrowserWeb)});var ee=y('<div class="loading loading-spinner loading-lg text-blue-500"></div>'),te=y('<div class="mb-2 text-4xl"><!></div>'),ae=y('<div class="flex min-h-screen items-center justify-center bg-gray-50"><div class="text-center"><div class="mb-4"><!></div> <h1 class="mb-2 text-xl font-semibold text-gray-900"> </h1> <p class="text-sm text-gray-600"><!></p></div></div>');function me(g,E){W(E,!1);let p=S(!0),a=S("Processing authentication...");Y(async()=>{try{const e=window.location.href;if(console.log("Auth callback URL:",e),b.isEmailLink(e)){console.log("Processing magic link"),s(a,"Completing sign-in from email link...");const t=await b.completeMagicLinkSignIn(e);if(t){if(s(a,"Email sign-in successful! Redirecting..."),console.log("Magic link sign-in successful:",t.uid),T.isNativePlatform())try{await C.close()}catch(u){console.warn("Could not close browser:",u)}setTimeout(()=>{v("/",{replaceState:!0})},1e3)}else s(a,"Email sign-in failed. Please try again."),setTimeout(()=>{v("/",{replaceState:!0})},3e3)}else{const t=await b.getCurrentUserAsync();if(t){if(s(a,"Authentication successful! Redirecting..."),console.log("User is authenticated:",t.uid),T.isNativePlatform())try{await C.close()}catch(u){console.warn("Could not close browser:",u)}setTimeout(()=>{v("/",{replaceState:!0})},1e3)}else s(a,"No authentication found. Redirecting to home..."),console.log("No authenticated user found"),setTimeout(()=>{v("/",{replaceState:!0})},2e3)}}catch(e){console.error("Auth callback error:",e),s(a,"Authentication failed. Please try again."),setTimeout(()=>{v("/",{replaceState:!0})},3e3)}finally{s(p,!1)}}),O();var h=ae();q(e=>{G.title="Authentication - PhotoTV"});var P=l(h),_=l(P),R=l(_);{var L=e=>{var t=ee();i(e,t)},N=e=>{var t=te(),u=l(t);{var j=o=>{var d=m("✅");i(o,d)},V=o=>{var d=Q(),D=X(d);{var J=r=>{var x=m("❌");i(r,x)},K=r=>{var x=m("ℹ️");i(r,x)};f(D,r=>{n(a).includes("failed")||n(a).includes("error")?r(J):r(K,!1)},!0)}i(o,d)};f(u,o=>{n(a).includes("successful")?o(j):o(V,!1)})}c(t),i(e,t)};f(R,e=>{n(p)?e(L):e(N,!1)})}c(_);var w=A(_,2),B=l(w,!0);c(w);var k=A(w,2),I=l(k);{var M=e=>{var t=m("Please wait while we process your authentication...");i(e,t)},U=e=>{var t=m("You will be redirected automatically...");i(e,t)};f(I,e=>{n(p)?e(M):e(U,!1)})}c(k),c(P),c(h),z(()=>H(B,n(a))),i(g,h),F()}export{me as component};

import"../chunks/NZTpNUN0.js";import{i as Pe}from"../chunks/CeCCmokf.js";import{o as ze,a as Be,e as u}from"../chunks/C1kKUYEy.js";import{p as Le,l as We,a as Te,f as v,b as l,c as Ne,s as n,m as h,g as e,$ as ne,d as _,u as L,e as C,r as x,h as W,t as ie,i as $,j as q,n as Se,k as Ue}from"../chunks/1i-y1yM3.js";import{i as b,b as oe}from"../chunks/vcaSNNIp.js";import{o as Ve,a as Fe,r as se,s as le,l as ce,g as Ke,d as Oe,b as Ge}from"../chunks/BdwO4JHG.js";import{g as ge}from"../chunks/DM5PEVCe.js";var $e=v('<button class="btn btn-circle btn-ghost hover:bg-opacity-20 fixed top-4 left-4 z-20 bg-gray-200 text-gray-700 hover:bg-gray-300" aria-label="Go back to main menu"><svg class="h-6 w-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h12a1 1 0 001-1V10"></path></svg></button>'),qe=v('<div class="fixed top-4 right-4 z-20 flex space-x-2"><button class="btn btn-circle btn-ghost hover:bg-opacity-20 bg-gray-200 text-gray-700 hover:bg-gray-300" aria-label="Previous image"><svg class="h-6 w-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path></svg></button> <button class="btn btn-circle btn-ghost hover:bg-opacity-20 bg-gray-200 text-gray-700 hover:bg-gray-300" aria-label="Next image"><svg class="h-6 w-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path></svg></button></div>'),Je=v('<button class="btn btn-circle btn-ghost hover:bg-opacity-20 fixed top-4 left-1/2 z-20 -translate-x-1/2 transform bg-gray-200 text-gray-700 hover:bg-gray-300" aria-label="Delete current image"><svg class="h-6 w-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1-1H8a1 1 0 00-1 1v3M4 7h16"></path></svg></button>'),Qe=v('<span class="loading loading-spinner loading-sm"></span> Deleting...',1),Xe=v('<div class="bg-opacity-75 fixed inset-0 z-50 flex items-center justify-center bg-black"><div class="mx-4 max-w-md rounded-lg bg-white p-6 shadow-xl"><h3 class="mb-4 text-lg font-bold text-gray-900">Delete Image</h3> <p class="mb-6 text-gray-700">Are you sure you want to delete this image? This action cannot be undone.</p> <div class="flex justify-end space-x-3"><button class="rounded bg-gray-200 px-4 py-2 text-gray-800 hover:bg-gray-300">Cancel</button> <button class="rounded bg-red-600 px-4 py-2 text-white hover:bg-red-700 disabled:opacity-50"><!></button></div></div></div>'),Ye=v('<div class="loading loading-spinner loading-lg"></div>'),Ze=v('<button class="btn btn-primary">Upload Images through phone app</button>'),et=v('<div class="loading loading-spinner loading-lg"></div>'),tt=v('<div class="picture-frame svelte-2nocfa"><img alt="" class="framed-image svelte-2nocfa"/></div>'),at=v('<div class="absolute inset-0 flex items-center justify-center p-8"><!></div>'),rt=v('<div class="fixed inset-0 flex flex-col bg-black" role="button" tabindex="0"><!> <!> <!> <!> <div class="absolute inset-0 flex items-center justify-center"><!></div></div>');function dt(de,fe){Le(fe,!1);let R=null,r=h([]),m=0,p=h(""),T=h(!0),A=h(""),j=null,N=h(!1),w=h(!1),S=h(!1),M=h(!1);ze(()=>Ve(Fe,async a=>{R=a,a?await ue():ge("/")})),Be(()=>{j&&clearInterval(j)});async function ue(){if(R)try{n(T,!0);const t=se(le,`images/${R.uid}`),a=await ce(t);n(r,a.items.sort((i,c)=>i.name.localeCompare(c.name))),e(r).length>0?(await P(),ve()):n(A,"No images found. Please upload some images first.")}catch(t){console.error("Error loading image list:",t),n(A,"Failed to load images. Please try again.")}finally{n(T,!1)}}async function P(){if(e(r).length!==0)try{n(N,!0);const t=e(r)[m];n(p,await Ke(t))}catch(t){console.error("Error loading current image:",t)}finally{n(N,!1)}}function ve(){e(r).length!==0&&(j&&clearInterval(j),j=setInterval(async()=>{await V()},1e4))}function U(){ge("/")}async function V(){e(r).length>0&&(await me(),m=(m+1)%e(r).length,await P())}async function J(){e(r).length>0&&(m=m===0?e(r).length-1:m-1,await P())}async function me(){if(R)try{const t=se(le,`images/${R.uid}`),i=(await ce(t)).items.sort((c,y)=>c.name.localeCompare(y.name));i.length!==e(r).length&&n(r,i)}catch(t){console.error("Error refreshing image list:",t)}}function he(t){switch(t.key){case"ArrowRight":case" ":V();break;case"ArrowLeft":J();break;case"Escape":U();break;case"Enter":case"c":case"C":F();break}}function be(){n(S,!0)}function Q(){n(S,!1)}async function pe(){if(!(!R||e(r).length===0))try{n(M,!0);const t=e(r)[m];await Oe(t),n(r,e(r).filter((a,i)=>i!==m)),m>=e(r).length&&(m=Math.max(0,e(r).length-1)),e(r).length>0?await P():(n(p,""),n(A,"No images found. Please upload some images first.")),Q()}catch(t){console.error("Error deleting image:",t),alert("Failed to delete image. Please try again.")}finally{n(M,!1)}}function F(){n(w,!e(w))}function ye(t){t.target.closest("button")||F()}function _e(t){t.key==="Enter"&&F()}let o=h(),K=h();function X(){if(!e(o)||!e(K)||!e(p))return;const t=window.innerWidth,a=window.innerHeight,i=new Image;i.onload=function(){const c=this.naturalWidth/this.naturalHeight,y=t/a;let s,d,k,I;if(c>y){I=d=100;const f=(t-200)/c,H=a-f;s=k=Math.max(100,H/2)}else{s=k=100;const f=(a-200)*c,H=t-f;I=d=Math.max(100,H/2)}e(o)&&(W(o,e(o).style.paddingTop=`${s}px`),W(o,e(o).style.paddingRight=`${d}px`),W(o,e(o).style.paddingBottom=`${k}px`),W(o,e(o).style.paddingLeft=`${I}px`))},i.src=e(p)}function xe(){e(p)&&e(o)&&setTimeout(X,100)}We(()=>(e(p),e(o)),()=>{e(p)&&e(o)&&setTimeout(X,100)}),Te(),Pe();var E=rt();u("keydown",ne,he),u("resize",ne,xe);var Y=_(E);{var we=t=>{var a=$e();u("click",a,U),l(t,a)};b(Y,t=>{e(r),e(w),L(()=>e(r).length>0&&e(w))&&t(we)})}var Z=C(Y,2);{var ke=t=>{var a=qe(),i=_(a),c=C(i,2);x(a),u("click",i,J),u("click",c,V),l(t,a)};b(Z,t=>{e(r),e(w),L(()=>e(r).length>0&&e(w))&&t(ke)})}var ee=C(Z,2);{var Ie=t=>{var a=Je();u("click",a,be),l(t,a)};b(ee,t=>{e(r),e(w),L(()=>e(r).length>0&&e(w))&&t(Ie)})}var te=C(ee,2);{var Ce=t=>{var a=Xe(),i=_(a),c=C(_(i),4),y=_(c),s=C(y,2),d=_(s);{var k=g=>{var f=Qe();Se(),l(g,f)},I=g=>{var f=Ue("Delete");l(g,f)};b(d,g=>{e(M)?g(k):g(I,!1)})}x(s),x(c),x(i),x(a),ie(()=>{y.disabled=e(M),s.disabled=e(M)}),u("click",y,Q),u("click",s,pe),l(t,a)};b(te,t=>{e(S)&&t(Ce)})}var ae=C(te,2),Re=_(ae);{var De=t=>{var a=Ye();l(t,a)},je=t=>{var a=$(),i=q(a);{var c=s=>{var d=Ze();u("click",d,U),l(s,d)},y=s=>{var d=$(),k=q(d);{var I=g=>{var f=at(),H=_(f);{var Me=D=>{var z=et();l(D,z)},Ee=D=>{var z=$(),He=q(z);{var Ae=O=>{var B=tt(),re=_(B);oe(re,G=>n(K,G),()=>e(K)),x(B),oe(B,G=>n(o,G),()=>e(o)),ie(()=>Ge(re,"src",e(p))),l(O,B)};b(He,O=>{e(p)&&O(Ae)},!0)}l(D,z)};b(H,D=>{e(N)?D(Me):D(Ee,!1)})}x(f),l(g,f)};b(k,g=>{e(r),L(()=>e(r).length>0)&&g(I)},!0)}l(s,d)};b(i,s=>{e(A)?s(c):s(y,!1)},!0)}l(t,a)};b(Re,t=>{e(T)?t(De):t(je,!1)})}x(ae),x(E),u("click",E,ye),u("keydown",E,_e),l(de,E),Ne()}export{dt as component};

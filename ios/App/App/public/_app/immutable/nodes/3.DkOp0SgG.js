import"../chunks/NZTpNUN0.js";import{i as ke}from"../chunks/DmtWXkJs.js";import{p as Ie,o as Ce,a as je,f as l,e as v,b as n,c as De,s as o,m as f,g as t,$ as Me,d as h,h as y,r as b,t as X,i as H,j as K,n as Re,k as Ee}from"../chunks/xY4BzElm.js";import{i as u}from"../chunks/37DlUv7F.js";import{o as Ae,a as Be,r as Y,s as Z,l as $,g as Le,d as Pe,b as ze}from"../chunks/BliC9dKz.js";import{g as ee}from"../chunks/DHVU9EpJ.js";var Ne=l('<button class="btn btn-circle btn-ghost hover:bg-opacity-20 fixed top-4 left-4 z-20 text-white hover:bg-white" aria-label="Go back to main menu"><svg class="h-6 w-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h12a1 1 0 001-1V10"></path></svg></button>'),Se=l('<div class="fixed top-4 right-4 z-20 flex space-x-2"><button class="btn btn-circle btn-ghost hover:bg-opacity-20 text-white hover:bg-white" aria-label="Previous image"><svg class="h-6 w-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path></svg></button> <button class="btn btn-circle btn-ghost hover:bg-opacity-20 text-white hover:bg-white" aria-label="Next image"><svg class="h-6 w-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path></svg></button></div>'),Ue=l('<button class="btn btn-circle btn-ghost hover:bg-opacity-20 fixed top-4 left-1/2 z-20 -translate-x-1/2 transform text-white hover:bg-white" aria-label="Delete current image"><svg class="h-6 w-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1-1H8a1 1 0 00-1 1v3M4 7h16"></path></svg></button>'),Fe=l('<span class="loading loading-spinner loading-sm"></span> Deleting...',1),He=l('<div class="bg-opacity-75 fixed inset-0 z-50 flex items-center justify-center bg-black"><div class="mx-4 max-w-md rounded-lg bg-white p-6 shadow-xl"><h3 class="mb-4 text-lg font-bold text-gray-900">Delete Image</h3> <p class="mb-6 text-gray-700">Are you sure you want to delete this image? This action cannot be undone.</p> <div class="flex justify-end space-x-3"><button class="rounded bg-gray-200 px-4 py-2 text-gray-800 hover:bg-gray-300">Cancel</button> <button class="rounded bg-red-600 px-4 py-2 text-white hover:bg-red-700 disabled:opacity-50"><!></button></div></div></div>'),Ke=l('<div class="loading loading-spinner loading-lg"></div>'),Ve=l('<button class="btn btn-primary">Upload Images through phone app</button>'),Ge=l('<div class="loading loading-spinner loading-lg"></div>'),Oe=l('<img alt="" class="h-full w-full object-contain"/>'),Te=l('<div class="absolute inset-0 flex items-center justify-center"><!></div>'),qe=l('<div class="fixed inset-0 flex flex-col bg-black" role="button" tabindex="0"><!> <!> <!> <!> <div class="absolute inset-0 flex items-center justify-center"><!></div></div>');function $e(te,ae){Ie(ae,!1);let _=null,r=f([]),c=0,D=f(""),A=f(!0),M=f(""),k=null,B=f(!1),I=f(!1),L=f(!1),C=f(!1);Ce(()=>Ae(Be,async a=>{_=a,a?await re():ee("/")})),je(()=>{k&&clearInterval(k)});async function re(){if(_)try{o(A,!0);const e=Y(Z,`images/${_.uid}`),a=await $(e);o(r,a.items.sort((i,g)=>i.name.localeCompare(g.name))),t(r).length>0?(await R(),oe()):o(M,"No images found. Please upload some images first.")}catch(e){console.error("Error loading image list:",e),o(M,"Failed to load images. Please try again.")}finally{o(A,!1)}}async function R(){if(t(r).length!==0)try{o(B,!0);const e=t(r)[c];o(D,await Le(e))}catch(e){console.error("Error loading current image:",e)}finally{o(B,!1)}}function oe(){t(r).length!==0&&(k&&clearInterval(k),k=setInterval(async()=>{await z()},5e3))}function P(){ee("/")}async function z(){t(r).length>0&&(await ne(),c=(c+1)%t(r).length,await R())}async function V(){t(r).length>0&&(c=c===0?t(r).length-1:c-1,await R())}async function ne(){if(_)try{const e=Y(Z,`images/${_.uid}`),i=(await $(e)).items.sort((g,m)=>g.name.localeCompare(m.name));i.length!==t(r).length&&o(r,i)}catch(e){console.error("Error refreshing image list:",e)}}function ie(e){switch(e.key){case"ArrowRight":case" ":z();break;case"ArrowLeft":V();break;case"Escape":P();break;case"Enter":case"c":case"C":N();break}}function se(){o(L,!0)}function G(){o(L,!1)}async function le(){if(!(!_||t(r).length===0))try{o(C,!0);const e=t(r)[c];await Pe(e),o(r,t(r).filter((a,i)=>i!==c)),c>=t(r).length&&(c=Math.max(0,t(r).length-1)),t(r).length>0?await R():(o(D,""),o(M,"No images found. Please upload some images first.")),G()}catch(e){console.error("Error deleting image:",e),alert("Failed to delete image. Please try again.")}finally{o(C,!1)}}function N(){o(I,!t(I))}function ce(e){e.target.closest("button")||N()}function ge(e){e.key==="Enter"&&N()}ke();var j=qe();v("keydown",Me,ie);var O=h(j);{var de=e=>{var a=Ne();v("click",a,P),n(e,a)};u(O,e=>{t(r).length>0&&t(I)&&e(de)})}var T=y(O,2);{var ve=e=>{var a=Se(),i=h(a),g=y(i,2);b(a),v("click",i,V),v("click",g,z),n(e,a)};u(T,e=>{t(r).length>0&&t(I)&&e(ve)})}var q=y(T,2);{var ue=e=>{var a=Ue();v("click",a,se),n(e,a)};u(q,e=>{t(r).length>0&&t(I)&&e(ue)})}var J=y(q,2);{var fe=e=>{var a=He(),i=h(a),g=y(h(i),4),m=h(g),s=y(m,2),p=h(s);{var S=d=>{var w=Fe();Re(),n(d,w)},U=d=>{var w=Ee("Delete");n(d,w)};u(p,d=>{t(C)?d(S):d(U,!1)})}b(s),b(g),b(i),b(a),X(()=>{m.disabled=t(C),s.disabled=t(C)}),v("click",m,G),v("click",s,le),n(e,a)};u(J,e=>{t(L)&&e(fe)})}var Q=y(J,2),he=h(Q);{var be=e=>{var a=Ke();n(e,a)},me=e=>{var a=H(),i=K(a);{var g=s=>{var p=Ve();v("click",p,P),n(s,p)},m=s=>{var p=H(),S=K(p);{var U=d=>{var w=Te(),pe=h(w);{var we=x=>{var E=Ge();n(x,E)},ye=x=>{var E=H(),_e=K(E);{var xe=F=>{var W=Oe();X(()=>ze(W,"src",t(D))),n(F,W)};u(_e,F=>{t(D)&&F(xe)},!0)}n(x,E)};u(pe,x=>{t(B)?x(we):x(ye,!1)})}b(w),n(d,w)};u(S,d=>{t(r).length>0&&d(U)},!0)}n(s,p)};u(i,s=>{t(M)?s(g):s(m,!1)},!0)}n(e,a)};u(he,e=>{t(A)?e(be):e(me,!1)})}b(Q),b(j),v("click",j,ce),v("keydown",j,ge),n(te,j),De()}export{$e as component};

<!doctype html>
<html lang="en">
	<head>
		<meta charset="utf-8" />
		<link rel="icon" href="%sveltekit.assets%/favicon.png" />
		<meta
			name="viewport"
			content="width=device-width, initial-scale=1, viewport-fit=cover, user-scalable=no"
		/>
		<meta name="theme-color" content="#000000" />
		<meta name="mobile-web-app-capable" content="yes" />
		<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
		<meta name="apple-mobile-web-app-title" content="PhotoTV" />
		<meta name="apple-touch-fullscreen" content="yes" />
		<meta name="format-detection" content="telephone=no" />
		<style>
			/* Improve touch responsiveness on Echo Show and other touch devices */
			* {
				-webkit-tap-highlight-color: transparent;
				-webkit-touch-callout: none;
				-webkit-user-select: none;
				-khtml-user-select: none;
				-moz-user-select: none;
				-ms-user-select: none;
				user-select: none;
				/* Fire TV specific touch optimizations */
				touch-action: manipulation;
			}

			/* Body optimizations for Fire TV Echo Show */
			body {
				/* Prevent overscroll bounce on Fire TV */
				overscroll-behavior: none;
				/* Optimize for touch */
				-webkit-overflow-scrolling: touch;
			}

			/* Allow text selection for inputs and content areas */
			input,
			textarea,
			[contenteditable='true'] {
				-webkit-user-select: text;
				-khtml-user-select: text;
				-moz-user-select: text;
				-ms-user-select: text;
				user-select: text;
			}

			/* Improve button touch targets and focus for Fire TV remote */
			button,
			.btn,
			[role='button'] {
				min-height: 44px;
				min-width: 44px;
				/* Fire TV focus improvements */
				cursor: pointer;
				outline: none;
			}

			/* Fire TV specific focus styles */
			button:focus,
			.btn:focus,
			[role='button']:focus {
				outline: 3px solid #3b82f6;
				outline-offset: 2px;
				z-index: 1000;
			}

			/* Fire TV Echo Show touch debugging styles */
			.touch-debug-overlay {
				position: fixed;
				top: 0;
				left: 0;
				width: 100%;
				height: 100%;
				pointer-events: none;
				z-index: 9999;
				background: rgba(255, 0, 0, 0.1);
				display: none;
			}

			.touch-debug-overlay.active {
				display: block;
			}

			/* Fire TV Echo Show specific touch area improvements */
			@media (pointer: coarse) {
				button,
				.btn,
				[role='button'] {
					min-height: 48px;
					min-width: 48px;
				}
			}

			/* Prevent text selection during swipe gestures */
			.slideshow-container,
			.slideshow-container * {
				-webkit-user-select: none;
				-moz-user-select: none;
				user-select: none;
			}

			/* Optimize for TV displays */
			@media (display-mode: fullscreen) {
				body {
					margin: 0;
					padding: 0;
					overflow: hidden;
				}
			}
		</style>
		<link rel="manifest" href="%sveltekit.assets%/manifest.json" />
		%sveltekit.head%
	</head>
	<body data-sveltekit-preload-data="hover">
		<div style="display: contents">%sveltekit.body%</div>

		<!-- Fire TV Echo Show Touch Debugging Script -->
		<script>
			// Global touch event debugging for Fire TV Echo Show
			if (typeof window !== 'undefined') {
				let touchDebugEnabled = false;

				// Check if touch debug is enabled
				const checkTouchDebug = () => {
					try {
						return localStorage.getItem('touch_debug') === 'true';
					} catch {
						return false;
					}
				};

				// Log touch events globally
				const logTouchEvent = (type, event) => {
					if (!checkTouchDebug()) return;

					const touch = type === 'touchend' ? event.changedTouches[0] : event.touches[0];
					if (!touch) return;

					console.log(`[Global Touch] ${type}:`, {
						x: Math.round(touch.clientX),
						y: Math.round(touch.clientY),
						target: event.target.tagName || 'unknown',
						timestamp: Date.now(),
						userAgent: navigator.userAgent.includes('AFT') ? 'Fire TV' : 'Other'
					});
				};

				// Add global touch listeners
				document.addEventListener('touchstart', (e) => logTouchEvent('touchstart', e), {
					passive: false
				});
				document.addEventListener('touchmove', (e) => logTouchEvent('touchmove', e), {
					passive: false
				});
				document.addEventListener('touchend', (e) => logTouchEvent('touchend', e), {
					passive: false
				});

				// Debug info on page load
				if (checkTouchDebug()) {
					console.log('[Fire TV Debug] Page loaded with touch debug enabled');
					console.log('[Fire TV Debug] User Agent:', navigator.userAgent);
					console.log('[Fire TV Debug] Touch support:', 'ontouchstart' in window);
					console.log('[Fire TV Debug] Max touch points:', navigator.maxTouchPoints);
				}

				// Keyboard shortcut to toggle debug from anywhere
				document.addEventListener('keydown', (e) => {
					if (e.key === 'F12' || (e.ctrlKey && e.shiftKey && e.key === 'D')) {
						try {
							const current = localStorage.getItem('touch_debug') === 'true';
							localStorage.setItem('touch_debug', current ? 'false' : 'true');
							console.log(`[Fire TV Debug] Touch debugging ${current ? 'disabled' : 'enabled'}`);
						} catch (err) {
							console.warn('[Fire TV Debug] Cannot access localStorage:', err);
						}
						e.preventDefault();
					}
				});
			}
		</script>
	</body>
</html>
